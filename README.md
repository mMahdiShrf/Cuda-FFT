Here’s the full README (markdown) you can copy-paste into your repo:

```markdown
# FFT on CUDA (GPU) — Radix-2 / Radix-4

A minimal, educational implementation of **1-D complex FFT** on NVIDIA GPUs using **CUDA**.  
It includes:
- a **CPU reference FFT** (for correctness and timing),
- a **GPU implementation** with **radix-2** and **radix-4** kernels,
- a simple test harness that measures CPU/GPU runtimes and reports MSE.

---

## Files

> Your actual filenames may be autogenerated; this README maps them to friendly names.

```

include/
fft.h                 # public API (⚠️ “Do NOT MODIFY THIS FILE”)
src/
main.cu               # host driver: I/O, CPU FFT, timings, calls gpuKernel(...)
fft\_kernels.cu        # all CUDA kernels and the gpuKernel(...) launcher
docs/
reference.pdf         # (optional) GPU FFT reference paper / notes
helpers/
gputimer.h            # GPU wall-clock timer (used by main.cu)
gpuerrors.h           # CUDA error-checking macros (used by main.cu)

````

### Public API (`include/fft.h`)
```c
// Do NOT MODIFY THIS FILE
#ifndef FFT_H
#define FFT_H
#include <stdio.h>
#include <time.h>
#include <stdlib.h>
#include <math.h>
#include "cuda_runtime.h"
#include "device_launch_parameters.h"
#include "gputimer.h"
#include "gpuerrors.h"
#define PI 3.14159265

// Launches the GPU FFT (in-place on device buffers)
void gpuKernel(float* x_r_d, float* x_i_d, /*float* X_r_d, float* X_i_d,*/ 
               const unsigned int N, const unsigned int M);
#endif
// Do NOT MODIFY THIS FILE
````

---

## Build

**Requirements**

* CUDA Toolkit 11+ (with `nvcc`)
* A CUDA-capable NVIDIA GPU (set `-arch=sm_XX` for your GPU)
* C++17 host compiler

**Example (Linux / macOS)**

```bash
mkdir -p build && cd build
nvcc -O3 -use_fast_math -std=c++17 -arch=sm_70 \
     -I../include -I../helpers \
     ../src/main.cu ../src/fft_kernels.cu -o fft_cuda
```

**Example (Windows – MSVC x64 Native Tools)**

```bat
mkdir build && cd build
nvcc -O3 -use_fast_math -std=c++17 -arch=sm_70 ^
     -I..\include -I..\helpers ^
     ..\src\main.cu ..\src\fft_kernels.cu -o fft_cuda.exe
```

> If you don’t have `helpers/gputimer.h` and `helpers/gpuerrors.h`, add simple versions:
>
> * `gputimer.h` can wrap `cudaEvent_t` start/stop with `Elapsed()` in ms.
> * `gpuerrors.h` can define `HANDLE_ERROR(cudaCall)` to check and abort on non-success.

---

## Run

The program expects a single argument **M** (where `N = 2^M`), and supports `M ∈ [0, 26]`.

```bash
./fft_cuda 20   # N = 2^20 = 1,048,576
```

**Output format (example)**:

```
Device Name: NVIDIA ...
m=20 n=1048576 CPU=1234.56 ms GPU=78.90 ms GPU-Kernels=65.43 ms mse=1.2e-6
```

* `CPU` and `GPU` are host-side wall-clock times.
* `GPU-Kernels` is pure device time measured with `GpuTimer`.
* `mse` compares the GPU result with the CPU reference FFT.

---

## What’s implemented

* **In-place complex FFT** on device arrays `x_r_d`, `x_i_d` (real/imag).
* **Algorithm choice by size**:

  * if `M` is **odd** → **radix-2** kernels,
  * if `M` is **even** → **radix-4** kernels.
* **Reordering**:

  * `rearange_radix2(...)` does bit-reversal (radix-2 digit reverse),
  * `rearange_radix4(...)` does base-4 digit reversal.
* **Butterflies & Twiddles**:

  * `fft_kernel_radix2(...)` with `twiddle_radix2(...)` and `computeButterfly_radix2(...)`,
  * `fft_kernel_radix4(...)` with `twiddle_radix4(...)` and `computeButterfly_radix4(...)`.
* **CPU reference**:

  * A straightforward recursive Cooley–Tukey implementation (`cpuKernel`) for correctness.

---

## Usage pattern (inside `main.cu`)

1. Allocate host arrays, fill inputs randomly in `[-8, 8]`.
2. Copy to device, **call `gpuKernel(x_r_d, x_i_d, N, M)`**.
3. Copy back results, compute **MSE** vs. CPU FFT, print timings.

The GPU path currently performs **in-place** transforms; the commented outputs in `fft.h` show how you could switch to **out-of-place** if needed.

---

## Tips

* Best throughput on **power-of-two** sizes (already enforced by `N=2^M`).
* Tune `-arch=sm_XX`, block sizes, and shared-memory usage for your GPU.
* `-use_fast_math` can improve speed at a small accuracy cost; keep an eye on `mse`.


```
```
